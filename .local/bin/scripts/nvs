#!/bin/sh

set -eu

file="$SCRIPTS/$(basename "$1")"

test -d "$file" && exit
test -s "$file" || echo '#!/bin/sh' >"$file"

nvim "$file"

test -f "$file" || exit

if [ "$(cat "$file")" = '#!/bin/sh' ]; then
  rm "$file"
  exit 0
fi

test -x "$file" || chmod +x "$SCRIPTS/$(basename "$file")"
